--Éú»î¼¼ÄÜ
--ÖÆÔìÒÂ·þ

--±¾½Å±¾toÕ ðµ ½Å±¾ºÅ
x700960_g_ScriptID = 700960;

--Ô­ÁÏ±í
x700960_g_Stuff =
{
	--Å®ÕæÊÏ·þ
	[1] = {20103103, 20103112, 20103115, 20308071},
	[2] = {20103103, 20103112, 20103115, 20308071},
	[3] = {20103103, 20103112, 20103115, 20308071},
	[4] = {20103104, 20103113, 20103116, 20308072},
	[5] = {20103104, 20103113, 20103116, 20308072},
	[6] = {20103104, 20103113, 20103116, 20308072},
	[7]	=	{20103105, 20103114, 20103117, 20308073},
	[8]	=	{20103105, 20103114, 20103117, 20308073},
	[9]	=	{20103105, 20103114, 20103117, 20308073},
	--ÐÂÊ±×°
	[10] = {20103105,20103117,20103114,30503150},
	[11] = {20103105,20103117,20103114,30503151},
	[12] = {20103105,20103117,20103114,30503151},
	[13] = {20103105,20103117,20103114,30503151},
	[14] = {20103105,20103117,20103114,30503151},
	[15] = {20103105,20103117,20103114,30503158},
	[16] = {20103105,20103117,20103114,30503150},
	[17] = {20103105,20103117,20103114,30503150},
	[18] = {20103105,20103117,20103114,30503150},
	[19] = {20103105,20103117,20103114,30503150},
	[20] = {20103105,20103117,20103114,30503150},
	[21] = {20103105,20103117,20103114,30503150},
	[22] = {20103105,20103117,20103114,30503150},
	[23] = {20103105,20103117,20103114,30503150},
	[24] = {20103105,20103117,20103114,30503150},
	[25] = {20103105,20103117,20103114,30503150},
	[26] = {20103105,20103117,20103114,30503150},
	[27] = {20103105,20103117,20103114,30503150},
	[28] = {20103105,20103117,20103114,30503162},
	[29] = {20103105,20103117,20103114,30503162},
	[30] = {20103105,20103117,20103114,30503162},
	[31] = {20103105,20103117,20103114,30503162},
	[32] = {20103105,20103117,20103114,30503162},
	[33] = {20103105,20103117,20103114,30503162},
	[34] = {20103105,20103117,20103114,30503162},
	[35] = {20103105,20103117,20103114,30503162},
	[36] = {20103105,20103117,20103114,30503151},
}

--Ô­ÁÏÊýÁ¿
x700960_g_Count	=
{
	[1]	= {1, 50, 10, 1},
	[2] = {1, 55, 11, 1},
	[3] = {1, 60, 12, 1},
	[4] = {1, 50, 10, 1},
	[5] = {1, 55, 11, 1},
	[6] = {1, 60, 12, 1},
	[7]	=	{1, 50, 10, 1},
	[8]	=	{1, 11, 2, 1},
	[9]	=	{1, 50, 10, 1},
	[10] =	{10,10,10,1},
	[11] =	{10,10,10,1},
	[12] =	{10,10,10,1},
	[13] =	{10,10,10,1},
	[14] =	{10,10,10,1},
	[15] =	{10,10,10,1},
	[16] =	{10,10,10,1},
	[17] =	{10,10,10,1},
	[18] =	{10,10,10,1},
	[19] =	{10,10,10,1},
	[20] =	{10,10,10,1},
	[21] =	{10,10,10,1},
	[22] =	{10,10,10,1},
	[23] =	{10,10,10,1},
	[24] =	{10,10,10,1},
	[25] =	{10,10,10,1},
	[26] =	{10,10,10,1},
	[27] =	{10,10,10,1},
	[28] =	{10,10,10,1},
	[29] =	{10,10,10,1},
	[30] =	{10,10,10,1},
	[31] =	{10,10,10,1},
	[32] =	{10,10,10,1},
	[33] =	{10,10,10,1},
	[34] =	{10,10,10,1},
	[35] =	{10,10,10,1},
	[36] =	{10,10,10,1},
}

x700960_g_CompoundInfo = {}

--Å®ÕæÊÏ·þ
x700960_g_CompoundInfo[413] =
{
	abilityId	= ABILITY_FENGREN,
	recipeLevel = 1,
	deleteVigor = 90,
	matTbl =
	{
		{ matList = x700960_g_Stuff[1], count = x700960_g_Count[1], Product = 10124076,},
	},
}

x700960_g_CompoundInfo[414] =
{
	abilityId	= ABILITY_FENGREN,
	recipeLevel = 1,
	deleteVigor = 100,
	matTbl =
	{
		{ matList = x700960_g_Stuff[2], count = x700960_g_Count[2], Product = 10124077,},
	},
}

x700960_g_CompoundInfo[415] =
{
	abilityId	= ABILITY_FENGREN,
	recipeLevel = 1,
	deleteVigor = 110,
	matTbl =
	{
		{ matList = x700960_g_Stuff[3], count = x700960_g_Count[3], Product = 10124078,},
	},
}

x700960_g_CompoundInfo[416] =
{
	abilityId	= ABILITY_FENGREN,
	recipeLevel = 2,
	deleteVigor = 90,
	matTbl =
	{
		{ matList = x700960_g_Stuff[4], count = x700960_g_Count[4], Product = 10124079,},
	},
}

x700960_g_CompoundInfo[417] =
{
	abilityId	= ABILITY_FENGREN,
	recipeLevel = 2,
	deleteVigor = 100,
	matTbl =
	{
		{ matList = x700960_g_Stuff[5], count = x700960_g_Count[5], Product = 10124080,},
	},
}

x700960_g_CompoundInfo[418] =
{
	abilityId	= ABILITY_FENGREN,
	recipeLevel = 2,
	deleteVigor = 110,
	matTbl =
	{
		{ matList = x700960_g_Stuff[6], count = x700960_g_Count[6], Product = 10124081,},
	},
}

x700960_g_CompoundInfo[423] =
{
	abilityId	= ABILITY_FENGREN,
	recipeLevel = 3,
	deleteVigor = 90,
	matTbl =
	{
		{ matList = x700960_g_Stuff[7], count = x700960_g_Count[7], Product = 10124082,},
	},
}

x700960_g_CompoundInfo[530] =
{
	abilityId	= ABILITY_FENGREN,
	recipeLevel = 3,
	deleteVigor = 90,
	matTbl =
	{
		{ matList = x700960_g_Stuff[8], count = x700960_g_Count[8], Product = 10124071,},
	},
}

x700960_g_CompoundInfo[531] =
{
	abilityId	= ABILITY_FENGREN,
	recipeLevel = 3,
	deleteVigor = 110,
	matTbl =
	{
		{ matList = x700960_g_Stuff[9], count = x700960_g_Count[9], Product = 10124088,},
	},
}
--ÐÂÊ±×°
x700960_g_CompoundInfo[1235] =
{
	abilityId	= ABILITY_FENGREN,
	recipeLevel = 1,
	deleteVigor = 50,
	matTbl = 
	{
		{ matList = x700960_g_Stuff[10], count = x700960_g_Count[10], Product = 10124357,},
	},
}

x700960_g_CompoundInfo[1236] =
{
	abilityId	= ABILITY_FENGREN,
	recipeLevel = 1,
	deleteVigor = 50,
	matTbl = 
	{
		{ matList = x700960_g_Stuff[11], count = x700960_g_Count[11], Product = 10149054,},
	},
}

x700960_g_CompoundInfo[1237] =
{
	abilityId	= ABILITY_FENGREN,
	recipeLevel = 1,
	deleteVigor = 50,
	matTbl = 
	{
		{ matList = x700960_g_Stuff[12], count = x700960_g_Count[12], Product = 10149060,},
	},
}

x700960_g_CompoundInfo[1238] =
{
	abilityId	= ABILITY_FENGREN,
	recipeLevel = 1,
	deleteVigor = 50,
	matTbl = 
	{
		{ matList = x700960_g_Stuff[13], count = x700960_g_Count[13], Product = 10149063,},
	},
}

x700960_g_CompoundInfo[1239] =
{
	abilityId	= ABILITY_FENGREN,
	recipeLevel = 1,
	deleteVigor = 50,
	matTbl = 
	{
		{ matList = x700960_g_Stuff[11], count = x700960_g_Count[11], Product = 10149046,},
	},
}

x700960_g_CompoundInfo[1240] =
{
	abilityId	= ABILITY_FENGREN,
	recipeLevel = 1,
	deleteVigor = 50,
	matTbl = 
	{
		{ matList = x700960_g_Stuff[15], count = x700960_g_Count[15], Product = 10553155,},
	},
}

x700960_g_CompoundInfo[1241] =
{
	abilityId	= ABILITY_FENGREN,
	recipeLevel = 1,
	deleteVigor = 50,
	matTbl = 
	{
		{ matList = x700960_g_Stuff[16], count = x700960_g_Count[16], Product = 10124360,},
	},
}

x700960_g_CompoundInfo[1242] =
{
	abilityId	= ABILITY_FENGREN,
	recipeLevel = 1,
	deleteVigor = 50,
	matTbl = 
	{
		{ matList = x700960_g_Stuff[17], count = x700960_g_Count[17], Product = 10124359,},
	},
}

x700960_g_CompoundInfo[1243] =
{
	abilityId	= ABILITY_FENGREN,
	recipeLevel = 1,
	deleteVigor = 50,
	matTbl = 
	{
		{ matList = x700960_g_Stuff[18], count = x700960_g_Count[18], Product = 10124358,},
	},
}

x700960_g_CompoundInfo[1244] =
{
	abilityId	= ABILITY_FENGREN,
	recipeLevel = 1,
	deleteVigor = 50,
	matTbl = 
	{
		{ matList = x700960_g_Stuff[19], count = x700960_g_Count[19], Product = 10124366,},
	},
}

x700960_g_CompoundInfo[1245] =
{
	abilityId	= ABILITY_FENGREN,
	recipeLevel = 1,
	deleteVigor = 50,
	matTbl = 
	{
		{ matList = x700960_g_Stuff[20], count = x700960_g_Count[20], Product = 10124361,},
	},
}

x700960_g_CompoundInfo[1246] =
{
	abilityId	= ABILITY_FENGREN,
	recipeLevel = 1,
	deleteVigor = 50,
	matTbl = 
	{
		{ matList = x700960_g_Stuff[21], count = x700960_g_Count[21], Product = 10124362,},
	},
}

x700960_g_CompoundInfo[1247] =
{
	abilityId	= ABILITY_FENGREN,
	recipeLevel = 1,
	deleteVigor = 50,
	matTbl = 
	{
		{ matList = x700960_g_Stuff[22], count = x700960_g_Count[22], Product = 10124363,},
	},
}

x700960_g_CompoundInfo[1248] =
{
	abilityId	= ABILITY_FENGREN,
	recipeLevel = 1,
	deleteVigor = 50,
	matTbl = 
	{
		{ matList = x700960_g_Stuff[23], count = x700960_g_Count[23], Product = 10124364,},
	},
}

x700960_g_CompoundInfo[1234] =
{
	abilityId	= ABILITY_FENGREN,
	recipeLevel = 1,
	deleteVigor = 50,
	matTbl = 
	{
		{ matList = x700960_g_Stuff[24], count = x700960_g_Count[24], Product = 10124365,},
	},
}
x700960_g_CompoundInfo[1250] =
{
	abilityId	= ABILITY_FENGREN,
	recipeLevel = 1,
	deleteVigor = 50,
	matTbl = 
	{
		{ matList = x700960_g_Stuff[25], count = x700960_g_Count[25], Product = 10124609,},
	},
}
x700960_g_CompoundInfo[1251] =
{
	abilityId	= ABILITY_FENGREN,
	recipeLevel = 1,
	deleteVigor = 50,
	matTbl = 
	{
		{ matList = x700960_g_Stuff[26], count = x700960_g_Count[26], Product = 10124610,},
	},
}
x700960_g_CompoundInfo[1252] =
{
	abilityId	= ABILITY_FENGREN,
	recipeLevel = 1,
	deleteVigor = 50,
	matTbl = 
	{
		{ matList = x700960_g_Stuff[27], count = x700960_g_Count[27], Product = 10124611,},
	},
}
x700960_g_CompoundInfo[1253] =
{
	abilityId	= ABILITY_FENGREN,
	recipeLevel = 1,
	deleteVigor = 50,
	matTbl = 
	{
		{ matList = x700960_g_Stuff[28], count = x700960_g_Count[28], Product = 10553116,},
	},
}
x700960_g_CompoundInfo[1254] =
{
	abilityId	= ABILITY_FENGREN,
	recipeLevel = 1,
	deleteVigor = 50,
	matTbl = 
	{
		{ matList = x700960_g_Stuff[29], count = x700960_g_Count[29], Product = 10553115,},
	},
}
x700960_g_CompoundInfo[1255] =
{
	abilityId	= ABILITY_FENGREN,
	recipeLevel = 1,
	deleteVigor = 50,
	matTbl = 
	{
		{ matList = x700960_g_Stuff[30], count = x700960_g_Count[30], Product = 10553117,},
	},
}
x700960_g_CompoundInfo[1256] =
{
	abilityId	= ABILITY_FENGREN,
	recipeLevel = 1,
	deleteVigor = 50,
	matTbl = 
	{
		{ matList = x700960_g_Stuff[31], count = x700960_g_Count[31], Product = 10553118,},
	},
}
x700960_g_CompoundInfo[1257] =
{
	abilityId	= ABILITY_FENGREN,
	recipeLevel = 1,
	deleteVigor = 50,
	matTbl = 
	{
		{ matList = x700960_g_Stuff[32], count = x700960_g_Count[32], Product = 10553124,},
	},
}
x700960_g_CompoundInfo[1258] =
{
	abilityId	= ABILITY_FENGREN,
	recipeLevel = 1,
	deleteVigor = 50,
	matTbl = 
	{
		{ matList = x700960_g_Stuff[33], count = x700960_g_Count[33], Product = 10553119,},
	},
}
x700960_g_CompoundInfo[1259] =
{
	abilityId	= ABILITY_FENGREN,
	recipeLevel = 1,
	deleteVigor = 50,
	matTbl = 
	{
		{ matList = x700960_g_Stuff[34], count = x700960_g_Count[34], Product = 10553120,},
	},
}
x700960_g_CompoundInfo[1233] =
{
	abilityId	= ABILITY_FENGREN,
	recipeLevel = 1,
	deleteVigor = 50,
	matTbl = 
	{
		{ matList = x700960_g_Stuff[35], count = x700960_g_Count[35], Product = 10553121,},
	},
}
x700960_g_CompoundInfo[1262] =
{
	abilityId	= ABILITY_FENGREN,
	recipeLevel = 1,
	deleteVigor = 50,
	matTbl = 
	{
		{ matList = x700960_g_Stuff[11], count = x700960_g_Count[11], Product = 10149076,},
	},
}
x700960_g_CompoundInfo[1263] =
{
	abilityId	= ABILITY_FENGREN,
	recipeLevel = 1,
	deleteVigor = 50,
	matTbl = 
	{
		{ matList = x700960_g_Stuff[11], count = x700960_g_Count[11], Product = 10149077,},
	},
}
x700960_g_CompoundInfo[1264] =
{
	abilityId	= ABILITY_FENGREN,
	recipeLevel = 1,
	deleteVigor = 50,
	matTbl = 
	{
		{ matList = x700960_g_Stuff[11], count = x700960_g_Count[11], Product = 10149078,},
	},
}
x700960_g_CompoundInfo[1265] =
{
	abilityId	= ABILITY_FENGREN,
	recipeLevel = 1,
	deleteVigor = 50,
	matTbl = 
	{
		{ matList = x700960_g_Stuff[11], count = x700960_g_Count[11], Product = 10149079,},
	},
}
x700960_g_CompoundInfo[1266] =
{
	abilityId	= ABILITY_FENGREN,
	recipeLevel = 1,
	deleteVigor = 50,
	matTbl = 
	{
		{ matList = x700960_g_Stuff[11], count = x700960_g_Count[11], Product = 10149080,},
	},
}
x700960_g_CompoundInfo[1267] =
{
	abilityId	= ABILITY_FENGREN,
	recipeLevel = 1,
	deleteVigor = 50,
	matTbl = 
	{
		{ matList = x700960_g_Stuff[11], count = x700960_g_Count[11], Product = 10149081,},
	},
}
x700960_g_CompoundInfo[1282] =
{
	abilityId	= ABILITY_FENGREN,
	recipeLevel = 1,
	deleteVigor = 50,
	matTbl = 
	{
		{ matList = x700960_g_Stuff[11], count = x700960_g_Count[11], Product = 10149073,},
	},
}
x700960_g_CompoundInfo[1283] =
{
	abilityId	= ABILITY_FENGREN,
	recipeLevel = 1,
	deleteVigor = 50,
	matTbl = 
	{
		{ matList = x700960_g_Stuff[11], count = x700960_g_Count[11], Product = 10149072,},
	},
}
x700960_g_CompoundInfo[1284] =
{
	abilityId	= ABILITY_FENGREN,
	recipeLevel = 1,
	deleteVigor = 50,
	matTbl = 
	{
		{ matList = x700960_g_Stuff[11], count = x700960_g_Count[11], Product = 10149071,},
	},
}

x700960_g_CompoundInfo[1268] =
{
	abilityId	= ABILITY_FENGREN,
	recipeLevel = 1,
	deleteVigor = 50,
	matTbl = 
	{
		{ matList = x700960_g_Stuff[27], count = x700960_g_Count[27], Product = 10124331,},
	},
}
x700960_g_CompoundInfo[1269] =
{
	abilityId	= ABILITY_FENGREN,
	recipeLevel = 1,
	deleteVigor = 50,
	matTbl = 
	{
		{ matList = x700960_g_Stuff[27], count = x700960_g_Count[27], Product = 10124367,},
	},
}
x700960_g_CompoundInfo[1270] =
{
	abilityId	= ABILITY_FENGREN,
	recipeLevel = 1,
	deleteVigor = 50,
	matTbl = 
	{
		{ matList = x700960_g_Stuff[27], count = x700960_g_Count[27], Product = 10124610,},
	},
}
x700960_g_CompoundInfo[1271] =
{
	abilityId	= ABILITY_FENGREN,
	recipeLevel = 1,
	deleteVigor = 50,
	matTbl = 
	{
		{ matList = x700960_g_Stuff[27], count = x700960_g_Count[27], Product = 10124369,},
	},
}
x700960_g_CompoundInfo[1272] =
{
	abilityId	= ABILITY_FENGREN,
	recipeLevel = 1,
	deleteVigor = 50,
	matTbl = 
	{
		{ matList = x700960_g_Stuff[27], count = x700960_g_Count[27], Product = 10124511,},
	},
}
x700960_g_CompoundInfo[1273] =
{
	abilityId	= ABILITY_FENGREN,
	recipeLevel = 1,
	deleteVigor = 50,
	matTbl = 
	{
		{ matList = x700960_g_Stuff[27], count = x700960_g_Count[27], Product = 10124521,},
	},
}
x700960_g_CompoundInfo[1274] =
{
	abilityId	= ABILITY_FENGREN,
	recipeLevel = 1,
	deleteVigor = 50,
	matTbl = 
	{
		{ matList = x700960_g_Stuff[27], count = x700960_g_Count[27], Product = 10124531,},
	},
}
x700960_g_CompoundInfo[1275] =
{
	abilityId	= ABILITY_FENGREN,
	recipeLevel = 1,
	deleteVigor = 50,
	matTbl = 
	{
		{ matList = x700960_g_Stuff[27], count = x700960_g_Count[27], Product = 10124541,},
	},
}
x700960_g_CompoundInfo[1276] =
{
	abilityId	= ABILITY_FENGREN,
	recipeLevel = 1,
	deleteVigor = 50,
	matTbl = 
	{
		{ matList = x700960_g_Stuff[27], count = x700960_g_Count[27], Product = 10124551,},
	},
}
x700960_g_CompoundInfo[1277] =
{
	abilityId	= ABILITY_FENGREN,
	recipeLevel = 1,
	deleteVigor = 50,
	matTbl = 
	{
		{ matList = x700960_g_Stuff[27], count = x700960_g_Count[27], Product = 10124561,},
	},
}
x700960_g_CompoundInfo[1278] =
{
	abilityId	= ABILITY_FENGREN,
	recipeLevel = 1,
	deleteVigor = 50,
	matTbl = 
	{
		{ matList = x700960_g_Stuff[27], count = x700960_g_Count[27], Product = 10124581,},
	},
}
x700960_g_CompoundInfo[1279] =
{
	abilityId	= ABILITY_FENGREN,
	recipeLevel = 1,
	deleteVigor = 50,
	matTbl = 
	{
		{ matList = x700960_g_Stuff[27], count = x700960_g_Count[27], Product = 10124591,},
	},
}
x700960_g_CompoundInfo[1280] =
{
	abilityId	= ABILITY_FENGREN,
	recipeLevel = 1,
	deleteVigor = 50,
	matTbl = 
	{
		{ matList = x700960_g_Stuff[27], count = x700960_g_Count[27], Product = 10124620,},
	},
}
x700960_g_CompoundInfo[1281] =
{
	abilityId	= ABILITY_FENGREN,
	recipeLevel = 1,
	deleteVigor = 50,
	matTbl = 
	{
		{ matList = x700960_g_Stuff[27], count = x700960_g_Count[27], Product = 10124630,},
	},
}
x700960_g_CompoundInfo[61] =
{
	abilityId	= ABILITY_FENGREN,
	recipeLevel = 1,
	deleteVigor = 50,
	matTbl = 
	{
		{ matList = x700960_g_Stuff[11], count = x700960_g_Count[11], Product = 10149074,},
	},
}

--±³°üC¥n có µÄ¿Õ¼ä
x700960_g_BagSpace = 1;

function x700960_AbilityCheck( sceneId, selfId, recipeId )

	local CompoundInfo	= x700960_g_CompoundInfo[recipeId];
	if(not CompoundInfo) then
		return OR_ERROR;
	end

	--±³°ü¿Õ¼ä¼ì²é
	if(LuaFnGetPropertyBagSpace(sceneId, selfId) < x700960_g_BagSpace) then
		return OR_BAG_OUT_OF_SPACE;
	end

	--¼¼ÄÜµÈc¤pÏÞÖÆ
	local abilityLevel = QueryHumanAbilityLevel(sceneId, selfId, CompoundInfo.abilityId);
	if(abilityLevel < CompoundInfo.recipeLevel) then
		return OR_NO_LEVEL
	end

	--»îÁ¦ÏÞÖÆ
	local vigor = GetHumanVigor(sceneId, selfId);
	if(vigor - CompoundInfo.deleteVigor < 0) then
		return OR_NOT_ENOUGH_VIGOR;
	end

	--²ÄÁÏÊýÁ¿ÏÞÖÆ
	local i, matInfo, tblCount, bMatEnoughFlag, idx, MatSN, Count, listCount;

	tblCount = getn( CompoundInfo.matTbl);
	bMatEnoughFlag = 0;

	for i=1,tblCount do
		Count = 0;
		matInfo = CompoundInfo.matTbl[i];
		if(not matInfo) then
			return OR_STUFF_LACK
		end

		if(not matInfo.matList) then
			return OR_STUFF_LACK;
		end

		listCount = getn(matInfo.matList);
		for j=1,listCount do
			MatSN = matInfo.matList[j];
			Count = LuaFnGetAvailableItemCount( sceneId, selfId, MatSN );

			if(Count < matInfo.count[j]) then
				return OR_STUFF_LACK;
			end
		end

	end


end

function x700960_AbilityProduce( sceneId, selfId, recipeId )

	local	CompoundInfo = x700960_g_CompoundInfo[recipeId];
	if(not CompoundInfo) then
		return OR_ERROR
	end

	--¿Û³ý»îÁ¦
	local vigor = GetHumanVigor(sceneId, selfId);
	vigor = vigor - CompoundInfo.deleteVigor;
	SetHumanVigor(sceneId, selfId, vigor);

	local i, matInfo, tblCount, bMatEnoughFlag, idx, MatSN, Count, DelCount, listCount, bagIndex;

	tblCount = getn(CompoundInfo.matTbl);
	DelCount = 0;

	for i = 1, tblCount do
		Count = 0;
		matInfo = CompoundInfo.matTbl[i];
		if(not matInfo) then
			return OR_STUFF_LACK
		end

		if(not matInfo.matList) then
			return OR_STUFF_LACK
		end

		listCount = getn(matInfo.matList);
		for j=1, listCount do
			MatSN = matInfo.matList[j];
			Count = LuaFnGetAvailableItemCount( sceneId, selfId, MatSN );

			if(Count < matInfo.count[j]) then
				return OR_STUFF_LACK
			end
		end

		--¿Û³ýÎïÆ·
		for j=1, listCount do
			MatSN = matInfo.matList[j];
			DelCount = LuaFnGetAvailableItemCount( sceneId, selfId, MatSN );

			if(DelCount > 0) then
				if(DelCount > matInfo.count[j]) then
					DelCount = matInfo.count[j];
				end
			end

			LuaFnDelAvailableItem( sceneId, selfId, MatSN, DelCount );
		end

		bagIndex = LuaFnTryRecieveItem( sceneId, selfId, matInfo.Product, QUALITY_MUST_BE_CHANGE );
		if(bagIndex < 0) then
			LuaFnAuditAbility(sceneId, selfId, CompoundInfo.abilityId, recipeId, 0)
			return OR_ERROR
		end

		local itemInfo = GetBagItemTransfer( sceneId, selfId, bagIndex );

		--TÕi ÕâÀï¹ã²¥
		BroadMsgByChatPipe( sceneId, selfId, "#{_INFOUSR"..GetName( sceneId, selfId).."}#Iträi qua muôn vàn khó khån tìm kiªm nguyên li®u cu¯i cùng cûng chª ðßþc #{_INFOMSG"..itemInfo.."}#Ith§t là mãn nguy®n , xin chúc m×ng", 4);
	end

	LuaFnSendAbilitySuccessMsg( sceneId, selfId, CompoundInfo.abilityId, recipeId, matInfo.Product )
	LuaFnAuditAbility(sceneId, selfId, CompoundInfo.abilityId, recipeId, 1)

	return OR_OK
end
